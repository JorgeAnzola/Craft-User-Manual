
{% extends "_layouts/cp" %}

{% do view.registerAssetBundle("roberskine\\usermanual\\assetbundles\\usermanual\\UserManualAsset") %}

{% set sectionSelected = (craft.userManual.settings.section is defined)
  ? craft.userManual.settings.section
  : "Homepage" %}

{% macro level(page) %}
  {% if page.level is defined and page.level > 1 %}
    {% for i in 2..page.level %}
      <div style="position: relative">
      <svg id="a" xmlns="http://www.w3.org/2000/svg" width="8" height="12" viewBox="0 0 12 12" style=" position: relative; top: 0.185rem"><rect x="2" y="5.5" width="7" height="1" rx=".5" ry=".5" style="fill:currentColor; stroke-width:0px; opacity: 0.5;"/></svg>
     </div>
    {% endfor %}
  {% endif %}
{% endmacro %}

{% set title = craft.userManual.name|t %}

{% if craft.userManual.settings.enabledSideBar %}
  {% set sidebar %}
    <nav id="user-manual-menu">
      {% set help = craft.entries.sectionId(sectionSelected).all() %}
      <ul>
        {% nav page in help %}
          {% set active = page.slug == craft.app.request.segments|last or loop.first and craft.app.request.segments|last == 'usermanual' %}
          <li id="{{ page.id }}">
            <a {% if active %}class="sel"{% endif %}
              href="{{ url('usermanual/' ~ page.uri) }}#{{ page.id }}">
              {{_self.level(page)}}{{page.title}}
            </a>
            {% ifchildren %}
                <ul>
                    {% children %}
                </ul>
            {% endifchildren %}
            </li>
        {% endnav %}
      </ul>
    </nav>
  {% endset %}
{% endif %}

{% set content %}
  <div id="user-manual">
    {{ getHelpDocument(sectionSelected)|raw }}
  </div>
{% endset %}
