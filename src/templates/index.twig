
{% extends "_layouts/cp" %}

{% do view.registerAssetBundle("roberskine\\usermanual\\assetbundles\\usermanual\\UserManualAsset") %}

{% set sectionSelected = (craft.userManual.settings.section is defined)
  ? craft.userManual.settings.section
  : "Homepage" %}

{% macro level(page) %}
  {% if page.level is defined and page.level > 1 %}
    {% for i in 2..page.level %}
      <?xml version="1.0" encoding="UTF-8"?><svg id="a" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"><path d="M9.67,8.93V2.33c0-1.29-1.04-2.33-2.33-2.33h0c-1.29,0-2.33,1.04-2.33,2.33v11.27c0,1.29,1.04,2.33,2.33,2.33h9.33c1.29,0,2.33-1.04,2.33-2.33h0c0-1.29-1.04-2.33-2.33-2.33h-4.67c-1.29,0-2.33-1.04-2.33-2.33Z" style="fill:#c7d2df; stroke-width:0px;"/></svg>
    {% endfor %}
  {% endif %}
{% endmacro %}

{% set title = craft.userManual.name|t %}

{% if craft.userManual.settings.enabledSideBar %}
  {% set sidebar %}
    <nav id="user-manual-menu">
      {% set help = craft.entries.sectionId(sectionSelected).all() %}
      <ul>
        {% nav page in help %}
          {% set active = page.slug == craft.app.request.segments|last or loop.first and craft.app.request.segments|last == 'usermanual' %}
          <li id="{{ page.id }}">
            <a {% if active %}class="sel"{% endif %}
              href="{{ url('usermanual/' ~ page.uri) }}#{{ page.id }}">
              {{_self.level(page)}}{{page.title}}
            </a>
            {% ifchildren %}
                <ul>
                    {% children %}
                </ul>
            {% endifchildren %}
            </li>
        {% endnav %}
      </ul>
    </nav>
  {% endset %}
{% endif %}

{% set content %}
  <div id="user-manual">
    {{ getHelpDocument(sectionSelected)|raw }}
  </div>
{% endset %}
